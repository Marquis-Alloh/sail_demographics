# =============================================================================
# Script: Create synthetic data .csv files (dev only)
# =============================================================================

library(tidyverse)
library(lubridate)
library(here)

# -----------------------------------------------------------------------------
# WLGP
# -----------------------------------------------------------------------------
WLGP <- tribble(
  ~ALF_E, ~EVENT_CD, ~EVENT_CD_VRS, ~EVENT_VAL, ~EVENT_DT, ~PRAC_CD_E, ~LSOA_CD, ~WOB, ~GNDR_CD, ~FROM_DT,
  1000000231, "m598", "2", 0, 1999, 45702, "W01001378", "W01001378", 1, "2025-05-07",
  1000000224, "m599", "2", 0, 1994, 45662, "W01001379", "W01001379", 2, "2012-11-11",
  1000000236, "m582", "2", 0, 2007, 45802, "W01002380", "W01001380", 9, "2003-07-06",
  1000000235, "m591", "2", 0, 2011, 45703, "W01003175", "W01001375", 1, "2012-02-16",
  1000000233, "m584", "2", 0, 1992, 44702, "W01000990", "W01001390", 1, "2022-08-06",
  1000000234, "m593", "2", 0, 2020, 45712, "W01000471", "W01001371", 2, "1995-05-06",
  1000000232, "m597", "2", 0, 2015, 44765, "W01002480", "W01001370", 8, "2011-05-08",
  1000000239, "m592", "2", 0, 2000, 45708, "W010003823","W01001382", 1, "2000-05-01"
) %>%
  mutate(FROM_DT = as.Date(FROM_DT))

# -----------------------------------------------------------------------------
# EDDS
# -----------------------------------------------------------------------------
EDDS <- tribble(
  ~ALFE_E, ~SEX, ~LSOA2011_CD, ~ADMIN_ARR_DT, ~ETHNIC_GROUP, ~AGE,
  1000000224, 1, "W01001051", "2023-05-07", "Z", 23,
  1000000233, 2, "W01000123", "2020-04-16", "Z", 12,
  1000000224, 1, "W01000092", "2005-05-16", "Z", 27,
  1000000224, 1, "W01002126", "2023-11-03", "Z", 34,
  1000000234, 2, "W01001033", "1993-05-06", "Z", 67,
  1000000232, 2, "W01001143", "2001-05-08", "Z", 53,
  1000000239, 2, "W01001023", "1994-11-03", "Z", 14
) %>%
  mutate(ADMIN_ARR_DT = as.Date(ADMIN_ARR_DT))

# -----------------------------------------------------------------------------
# OPDW
# -----------------------------------------------------------------------------
OPDW <- tribble(
  ~ALF_E, ~GNDR_CD, ~ATTEND_DT, ~AGE_AT_APPT, ~LSOA_11_CD,  ~LSOA_01_CD,
  1000000224, 2, 1997,  2,  "W01001444", "W01001444",
  1000000276, 2, 1999, 21,  "W01001031", "W01001031",
  1000000673, 1, 2000, 12,  "W01001000", "W01001000",
  1000000253, 2, 1998, 31,  "W01001333", "W01001333",
  1000061368, 1, 2001, 27,  "E01001444", "E01001444",
  1000000632, 2, 2013, 54,  "W01001431", "W01001431",
  1000010239, 1, 2011, 23,  "W01001243", "W01001243"
)

# -----------------------------------------------------------------------------
# PEDW_SPELL
# -----------------------------------------------------------------------------
PEDW_SPELL <- tribble(
  ~ALF_E,       ~LSOA_CD,   ~LSOA2011_CD, ~LSOA2001_CD, ~GNDR_CD, ~AVAIL_FROM_DT, ~AGE_EPI_STR, ~AGE_EPI_STR_UNDER1, ~ADMIS_DT,
  1000061366, "W01000797", "W01000797", "W01000797", 2, "2005-05-07", 12, NA, "2013-05-07",
  1000053256, "W01000707", "W01000707", "W01000707", 2, "2024-04-06", 32, NA, "2025-04-06",
  1000011576, "W01000796", "W01000796", "W01000796", 1, "2005-05-16", 24, NA, "2007-05-16",
  1000061363, "W01000497", "W01000497", "W01000497", 1, "2023-05-06", NA, 6,  "2024-02-06",
  1000061368, "W01000787", "W01000787", "W01000787", 2, "1995-05-06", 45, NA, "1998-05-06",
  1000061360, "W01000333", "W01000333", "W01000333", 1, "2011-05-08", 21, NA, "2012-05-08",
  1000061311, "W01000711", "W01000711", "W01000711", 2, "2000-05-01", NA, 2,  "2004-05-01"
) %>%
  mutate(
    AVAIL_FROM_DT = as.Date(AVAIL_FROM_DT),
    ADMIS_DT      = as.Date(ADMIS_DT)
  )

# -----------------------------------------------------------------------------
# Save CSV files
# -----------------------------------------------------------------------------
write_csv(WLGP,       here("tests", "testdata", "WLGP_GP_EVENT_CLEANSED.csv"))
write_csv(EDDS,       here("tests", "testdata", "EDDS_EDDS.csv"))
write_csv(OPDW,       here("tests", "testdata", "OPDW_OUTPATIENTS.csv"))
write_csv(PEDW_SPELL, here("tests", "testdata", "PEDW_SPELL.csv"))